---
date: 2026-02-26
topic: phase-4.2-whatsapp-pivot
phase: 4.2
condensed: true
original: archive/brainstorms/2026-02-26-phase-4.2-whatsapp-pivot-brainstorm.md
---

# Phase 4.2: WhatsApp Pivot (Condensed)

## Summary

Explored adding WhatsApp as the primary messaging channel using Twilio's WhatsApp Sandbox. The key insight was that Twilio's WhatsApp API uses the exact same webhook format as SMS (just a `whatsapp:` prefix on phone numbers), making this a ~30-line change in server.js rather than a rewrite. Also conducted competitive analysis against NanoClaw/OpenClaw, Claude Code Remote Control, and Remolt.

## Key Decisions

- **Twilio WhatsApp API, not Meta Cloud API direct**: Same webhook format as SMS (~20 lines changed vs ~150+); existing Twilio credentials work; $0.005/msg premium is negligible
- **Twilio sandbox for dev/testing**: No Meta Business verification needed to start; users send a join code to opt in
- **Same `/webhook` endpoint**: WhatsApp Sandbox webhook configured in Twilio Console, pointed at existing endpoint
- **Detect channel from `From` field prefix**: `whatsapp:+1234` vs `+1234` — Twilio's convention; strip prefix for allowlist check
- **Store channel per-user in `userState` Map**: Ensures outbound replies go back on correct channel
- **WhatsApp as primary (only) channel**: Not dual-channel; WhatsApp replaces SMS entirely
- **Text-first output formatting deferred**: Ship channel routing first; optimize output format later
- **VM completely unchanged**: Transport-agnostic; no changes to vm-server.js, Dockerfile, or docker-compose

## Outcomes

- WhatsApp advantages over SMS: monospace code blocks, 16MB media (vs ~1MB), in-order delivery, no carrier filtering, $0.005/msg vs $0.008-0.02/msg
- Changes limited to server.js (~30 lines) plus `.env` updates with `TWILIO_WHATSAPP_NUMBER`
- Unlocked future text-first output strategy (diffs as monospace text instead of PNG images)

## Status

Completed — Implemented in Phase 4.2
